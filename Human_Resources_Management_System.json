{"files":[{"id":"2feff68d-f089-494c-8359-967c0a9214cd","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Singapore\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"71a62f59-9b30-49be-b81a-375a7962b583","name":"Code","type":"server_js","source":"function checkInOut() {\n  var checkInTime \u003d new Date();\n  checkInTime.setHours(8, 30, 0, 0); // 08:30:00\n  \n  var checkOutTime \u003d new Date();\n  checkOutTime.setHours(17, 0, 0, 0); // 17:00:00\n  \n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();\n  var employeeId \u003d parseInt(Browser.inputBox(\u0027Enter your employee ID:\u0027));\n  \n  var employeeDataRange \u003d sheet.getRange(\u0027A:A\u0027); // Assuming employee IDs are in column A\n  var employeeData \u003d employeeDataRange.getValues().flat();\n  \n  if (employeeData.indexOf(employeeId) \u003e -1) {\n    var currentDateTime \u003d new Date();\n    var currentTime \u003d currentDateTime;\n    currentTime.setFullYear(1970, 0, 1); // Reset date part for comparison\n    \n    var row \u003d employeeData.indexOf(employeeId) + 1; // Adjust for 1-based index\n    var checkInRange \u003d sheet.getRange(row, 2, 1, 1); // Column B for check-in\n    var checkOutRange \u003d sheet.getRange(row, 3, 1, 1); // Column C for check-out\n    \n    // Check In\n    if (checkInRange.getValue() \u003d\u003d\u003d \u0027\u0027) {\n      if (currentTime \u003c\u003d checkInTime) {\n        checkInRange.setValue(currentDateTime);\n        Logger.log(\u0027Checked In\u0027);\n      } else {\n        checkInRange.setValue(currentDateTime);\n        Logger.log(\u0027Late Check In\u0027);\n        sheet.getRange(row, 4).setValue(\u0027late\u0027); // Column D for late status\n      }\n    }\n    \n    // Check Out\n    if (checkOutRange.getValue() \u003d\u003d\u003d \u0027\u0027) {\n      if (currentTime \u003e\u003d checkOutTime) {\n        checkOutRange.setValue(currentDateTime);\n        Logger.log(\u0027Checked Out\u0027);\n      } else {\n        checkOutRange.setValue(currentDateTime);\n        Logger.log(\u0027Early Check Out\u0027);\n        sheet.getRange(row, 5).setValue(\u0027early\u0027); // Column E for early status\n      }\n    }\n    \n    // Calculate late and early counts\n    var lateCount \u003d 0;\n    var earlyLeftCount \u003d 0;\n    \n    var checkInValues \u003d sheet.getRange(\u0027B:B\u0027).getValues().flat();\n    var checkOutValues \u003d sheet.getRange(\u0027E:E\u0027).getValues().flat();\n    \n    for (var i \u003d 0; i \u003c checkInValues.length; i++) {\n      if (checkInValues[i] !\u003d\u003d \u0027\u0027 \u0026\u0026 checkInValues[i + 2] \u003d\u003d\u003d \u0027late\u0027) {\n        lateCount++;\n      }\n    }\n    \n    for (var j \u003d 0; j \u003c checkOutValues.length; j++) {\n      if (checkOutValues[j] !\u003d\u003d \u0027\u0027 \u0026\u0026 checkOutValues[j + 2] \u003d\u003d\u003d \u0027early\u0027) {\n        earlyLeftCount++;\n      }\n    }\n    \n    var lateEarlyCount \u003d lateCount + earlyLeftCount;\n    \n    if (lateEarlyCount \u003e 10) {\n      Logger.log(\u0027Bad working attitude\u0027);\n    } else if (lateEarlyCount \u003c 2) {\n      Logger.log(\u0027Good working attitude\u0027);\n    } else {\n      Logger.log(\u0027Moderate performance\u0027);\n    }\n  } else {\n    Logger.log(\u0027There is no such employee\u0027);\n  }\n}"},{"id":"e5b5ff01-4a15-4e6b-b047-332c39f46dd0","name":"Payroll","type":"server_js","source":"\nfunction doGet() {\n  var sheetName \u003d \"Employees\";\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);\n\n  var ui \u003d SpreadsheetApp.getUi();\n  var EmployeeID \u003d ui.prompt(\"Enter EmployeeID: \", ui.ButtonSet.OK_CANCEL);\n  var Response \u003d EmployeeID.getResponseText;\n\n  var data \u003d sheet.getDataRange().getValues();\n  var headers \u003d data[0];\n  var jsonData \u003d [];\n  \n\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    var row \u003d data[i];\n    if (row[0] \u003d\u003d\u003d EmployeeID){\n      console.log(EmployeeID)\n    }\n    }\n  //   var rowObject \u003d {};\n\n  //   for (var j \u003d 0; j \u003c headers.length; j++) {\n  //     rowObject[headers[j]] \u003d row[j];\n  //   }\n\n  //   jsonData.push(rowObject);\n  // }\n\n  // console.log(jsonData)\n\n  // return ContentService.createTextOutput(JSON.stringify(jsonData))\n  //   .setMimeType(ContentService.MimeType.JSON);\n}\nfunction myFunction() {\ndoGet();  \n}"}]}